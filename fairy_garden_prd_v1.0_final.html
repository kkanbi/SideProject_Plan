<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fairy Garden (FocusPet) — PRD v1.0</title>
  <style>
    :root{
      --bg:#fafaf7;
      --ink:#223;
      --muted:#6b7280;
      --mint:#A6E3B7;
      --mint-dark:#7AA88C;
      --sky:#CDE6F7;
      --cream:#FFF9F1;
      --accent:#ffb7c5;
      --gold:#F7E7A9;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.55 "Pretendard", "Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;}
    .container{max-width:1000px;margin:0 auto;padding:28px 16px 80px;}
    header{display:flex;gap:18px;align-items:center;flex-wrap:wrap;margin-bottom:24px;}
    header h1{font-size:28px;line-height:1.2;margin:0;}
    header .tag{font-size:12px;padding:4px 8px;border-radius:999px;background:#eef2ff;color:#3730a3;margin-left:6px;}
    .card{background:white;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.06);padding:20px;margin:16px 0;}
    h2{font-size:20px;margin:18px 0 8px;}
    h3{font-size:16px;margin:14px 0 6px;color:#111827;}
    p,li{color:#1f2937}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:12px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:920px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}
    table{width:100%;border-collapse:separate;border-spacing:0 8px;}
    th,td{padding:10px 12px;background:#fff;border-bottom:1px solid #eef0f3}
    th{background:#f6f7fb;color:#374151;text-align:left;font-weight:600}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#eef9f1;color:#065f46;font-weight:600;font-size:12px}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;background:#111827;color:#f3f4f6;padding:2px 6px;border-radius:6px;font-size:12px}
    .caption{font-size:12px;color:#6b7280;margin-top:6px}
    .footer{margin-top:36px;font-size:12px;color:#6b7280}
    .hero{background:linear-gradient(180deg,var(--cream),#fff);border-radius:22px;padding:12px;display:flex;gap:20px;align-items:center;flex-wrap:wrap}
    .hero svg{width:320px;height:auto;flex:0 0 320px}
    .hero .copy{min-width:280px;flex:1}
    .badge{display:inline-flex;gap:8px;align-items:center;background:#ecfeff;color:#0369a1;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;margin-bottom:8px}
    .stat{display:flex;gap:12px;align-items:center;background:#f9fafb;border:1px dashed #e5e7eb;border-radius:12px;padding:8px 12px;margin-top:10px}
    .stat b{font-size:18px}
    .hr{height:1px;background:#eef0f3;margin:18px 0}
    .tagbar{display:flex;gap:8px;flex-wrap:wrap}
    .tagbar .tag2{background:#f1f5f9;color:#0f172a;border-radius:8px;padding:6px 10px;font-size:12px}
    .check{color:#059669;font-weight:700}
    .warn{color:#b45309;font-weight:700}
    .example{background:#f8fafc;border-left:3px solid var(--mint);padding:12px;margin:10px 0;border-radius:6px;}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Fairy Garden (FocusPet) — PRD</h1>
      <span class="tag">v1.0 · MVP</span>
      <span class="tag">iOS</span>
      <span class="tag">Android</span>
    </header>

    <!-- HERO -->
    <div class="card hero">
      <svg viewBox="0 0 420 420" role="img" aria-label="스노우볼 테라리움 안의 요정 정원 컨셉">
        <ellipse cx="210" cy="380" rx="145" ry="18" fill="#E8ECEF"/>
        <rect x="70" y="340" width="280" height="32" rx="10" fill="#C8A97A"/>
        <rect x="70" y="344" width="280" height="8" rx="6" fill="#B99262"/>
        <defs>
          <radialGradient id="g1" cx="50%" cy="40%" r="70%">
            <stop offset="0%" stop-color="#FFFFFF" stop-opacity=".9"/>
            <stop offset="100%" stop-color="#CFE9F9" stop-opacity=".8"/>
          </radialGradient>
          <linearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#CDE6F7"/>
            <stop offset="100%" stop-color="#A6E3B7"/>
          </linearGradient>
          <linearGradient id="hill" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#A6E3B7"/>
            <stop offset="100%" stop-color="#7AA88C"/>
          </linearGradient>
          <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="3" result="b"/>
            <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>
        <circle cx="210" cy="210" r="170" fill="url(#g1)"/>
        <clipPath id="clip">
          <circle cx="210" cy="210" r="160"></circle>
        </clipPath>
        <g clip-path="url(#clip)">
          <rect x="50" y="60" width="320" height="240" fill="url(#sky)"/>
          <g fill="#fff" opacity=".7">
            <circle cx="120" cy="110" r="2"/>
            <circle cx="310" cy="95" r="3"/>
            <circle cx="250" cy="130" r="2.5"/>
            <circle cx="160" cy="160" r="1.8"/>
            <circle cx="290" cy="170" r="2.2"/>
          </g>
          <ellipse cx="210" cy="260" rx="170" ry="60" fill="url(#hill)"/>
          <ellipse cx="260" cy="270" rx="110" ry="40" fill="#9FD6B0"/>
          <g stroke="#2f6f53" stroke-width="2" stroke-linecap="round">
            <path d="M135 270 q5 -14 10 0" fill="none"/>
            <path d="M150 275 q4 -12 8 0" fill="none"/>
            <path d="M175 280 q6 -16 12 0" fill="none"/>
            <path d="M240 275 q6 -16 12 0" fill="none"/>
            <path d="M285 278 q5 -14 10 0" fill="none"/>
          </g>
          <g transform="translate(210,210)">
            <g transform="translate(-10,0)">
              <ellipse cx="0" cy="45" rx="16" ry="22" fill="#ffd9e6"/>
              <circle cx="0" cy="20" r="12" fill="#ffe9f1"/>
              <path d="M -36 10 C -10 -10, -10 20, -36 28" fill="#E8F9FF" opacity=".75" filter="url(#glow)"/>
              <path d="M 36 10 C 10 -10, 10 20, 36 28" fill="#E8F9FF" opacity=".75" filter="url(#glow)"/>
              <circle cx="-3" cy="18" r="2" fill="#ff9ebb"/>
              <circle cx="3" cy="18" r="2" fill="#ff9ebb"/>
              <path d="M -6 26 q6 6 12 0" stroke="#ff9ebb" stroke-width="2" fill="none"/>
            </g>
          </g>
          <g fill="#FFF7CC" opacity=".9">
            <circle cx="210" cy="200" r="2.2"/>
            <circle cx="190" cy="220" r="1.8"/>
            <circle cx="230" cy="230" r="1.6"/>
          </g>
        </g>
        <path d="M90 110 q120 -80 240 0" stroke="#fff" stroke-width="6" stroke-linecap="round" opacity=".55" fill="none"/>
      </svg>
      <div class="copy">
        <div class="badge">요정의 정원 · 스노우볼 테라리움 컨셉</div>
        <h2 style="margin:6px 0 10px;">당신의 목표가 요정을 자라게 해요</h2>
        <p class="muted">스스로 정한 목표를 달성할 때마다 요정이 성장합니다. 30일 뒤, 완성된 요정을 도감에 기록하고 새로운 알을 시작하세요.</p>
        <div class="stat"><b>핵심 루프</b> <span class="muted">목표 설정 → 뽀모도로 달성 → 요정 성장 → 졸업 & 도감 등록 → 재시작</span></div>
      </div>
    </div>

    <!-- 1. 프로젝트 개요 -->
    <div class="card">
      <h2>1. 프로젝트 개요</h2>
      <p><b>목표:</b> 자기주도 목표 설정으로 뽀모도로 습관을 강화하는 힐링형 생산성 앱</p>
      <p><b>핵심 컨셉:</b> "당신이 정한 목표가 요정의 성장 속도를 결정한다." 목표를 달성하면 요정이 자라고, 30일 뒤 도감에 기록됩니다.</p>
      <div class="hr"></div>
      <div class="grid cols-3">
        <div><span class="pill">iOS / Android</span><div class="caption">Flutter 권장</div></div>
        <div><span class="pill">목표 기반 성장</span><div class="caption">유저가 목표 설정</div></div>
        <div><span class="pill">1인 개발 최적화</span><div class="caption">단순 로직 + 확장성</div></div>
      </div>
    </div>

    <!-- 2. 핵심 UX 루프 -->
    <div class="card">
      <h2>2. 핵심 UX 루프</h2>
      <pre class="kbd">알 받기(목표 설정) → 뽀모도로 달성 → 요정 성장 → 30일 졸업 → 도감 등록 → 새 알 시작</pre>
      <p class="muted caption">목표 달성 = 성장포인트 획득. 10일 미접속 시 요정과 정원이 잠듭니다.</p>
    </div>

    <!-- 4. 화면 구성 -->
    <div class="card">
      <h2>4. 화면 구성</h2>
      <p>MVP에 필요한 핵심 화면 5개와 각 화면의 주요 요소입니다.</p>
      
      <table>
        <tr><th>화면</th><th>주요 요소</th><th>기능</th></tr>
        <tr>
          <td><b>1. 로딩 화면</b></td>
          <td>
            • 앱 로고<br>
            • 버전 정보<br>
            • 로딩 인디케이터
          </td>
          <td>
            • 앱 초기화<br>
            • 데이터 로드<br>
            • 온보딩 여부 확인
          </td>
        </tr>
        <tr>
          <td><b>2. 메인 타이머 화면</b></td>
          <td>
            • 스노우볼 테라리움 배경<br>
            • 요정 애니메이션<br>
            • 타이머 (25:00)<br>
            • 시작/중지 버튼<br>
            • 하단 네비게이션 바
          </td>
          <td>
            • 뽀모도로 실행/중지<br>
            • 요정 상태 실시간 표시<br>
            • 오늘 달성 현황 (2/2 완료)
          </td>
        </tr>
        <tr>
          <td><b>3. 캐릭터 상태창</b></td>
          <td>
            • 요정 확대 이미지<br>
            • 레벨 & 경험치 바<br>
            • 누적 통계 (총 뽀모도로, 성공률)<br>
            • 성장 진행도 (21/60)<br>
            • 졸업까지 남은 일수
          </td>
          <td>
            • 메인 화면에서 요정 탭 시 팝업<br>
            • 성장 현황 확인<br>
            • 동기 부여 ("75% 달성!")
          </td>
        </tr>
        <tr>
          <td><b>4. 히스토리 창</b></td>
          <td>
            • 캘린더 뷰 (달성일 표시)<br>
            • 일별 뽀모도로 개수<br>
            • 카테고리별 통계 (Phase 2)<br>
            • 총 집중 시간<br>
            • 연속 달성일 (스트릭)
          </td>
          <td>
            • 하단 네비게이션에서 접근<br>
            • 성취감 시각화<br>
            • 패턴 분석 (언제 잘하나?)
          </td>
        </tr>
        <tr>
          <td><b>5. 설정창</b></td>
          <td>
            • 뽀모도로 시간 설정 (25/5분)<br>
            • 알림 설정<br>
            • 카테고리 관리 (Phase 2)<br>
            • 광고 제거 구매 버튼<br>
            • 프로젝트 초기화 (경고)
          </td>
          <td>
            • 하단 네비게이션에서 접근<br>
            • 사운드 on/off<br>
            • 개인 정보 정책 링크
          </td>
        </tr>
      </table>

      <h3>📱 하단 네비게이션 구성</h3>
      <div class="example">
        <b>4개 탭:</b><br>
        🏠 홈 (타이머) | 📊 히스토리 | 🛍️ 상점 | ⚙️ 설정
      </div>

      <h3>🛍️ 상점 화면 (Phase 1 간소화)</h3>
      <table>
        <tr><th>항목</th><th>Phase 1</th><th>Phase 3 확장</th></tr>
        <tr>
          <td>광고 제거</td>
          <td>✅ $2.99</td>
          <td>동일</td>
        </tr>
        <tr>
          <td>성장 부스트</td>
          <td>❌ 미제공</td>
          <td>✅ 레벨당 1개 제한</td>
        </tr>
        <tr>
          <td>정원 꾸미기</td>
          <td>❌ 미제공</td>
          <td>✅ 장식 아이템 10종</td>
        </tr>
      </table>
      <p class="muted caption">Phase 1에서는 광고 제거만 제공하여 스코프 최소화</p>
    </div>

    <!-- 5. 데이터 모델 상세 -->
    <div class="card">
      <h2>5. 데이터 모델 상세</h2>
      <p>로컬 DB(Hive/SQLite)에 저장되는 핵심 데이터 구조입니다.</p>

      <h3>📦 테이블 구조</h3>
      
      <h4>1️⃣ Project (프로젝트 설정)</h4>
      <table>
        <tr><th>필드</th><th>타입</th><th>설명</th><th>예시</th></tr>
        <tr><td>id</td><td>String</td><td>프로젝트 고유 ID</td><td>"proj_001"</td></tr>
        <tr><td>duration_days</td><td>int</td><td>목표 기간</td><td>30</td></tr>
        <tr><td>daily_goal</td><td>int</td><td>하루 목표 뽀모도로</td><td>2</td></tr>
        <tr><td>start_date</td><td>DateTime</td><td>시작일</td><td>2025-01-01</td></tr>
        <tr><td>end_date</td><td>DateTime</td><td>종료 예정일</td><td>2025-01-31</td></tr>
        <tr><td>is_active</td><td>bool</td><td>진행 중 여부</td><td>true</td></tr>
      </table>

      <h4>2️⃣ Fairy (요정 상태)</h4>
      <table>
        <tr><th>필드</th><th>타입</th><th>설명</th><th>예시</th></tr>
        <tr><td>id</td><td>String</td><td>요정 고유 ID</td><td>"fairy_001"</td></tr>
        <tr><td>project_id</td><td>String</td><td>연결된 프로젝트</td><td>"proj_001"</td></tr>
        <tr><td>level</td><td>int</td><td>현재 레벨 (1~4)</td><td>3</td></tr>
        <tr><td>total_pomodoros</td><td>int</td><td>누적 완료 개수</td><td>42</td></tr>
        <tr><td>color</td><td>String</td><td>선택한 색상 (Phase 2)</td><td>"mint"</td></tr>
        <tr><td>dominant_tag</td><td>String</td><td>타입 (Phase 2)</td><td>"study"</td></tr>
        <tr><td>is_sleeping</td><td>bool</td><td>잠든 상태</td><td>false</td></tr>
        <tr><td>last_active</td><td>DateTime</td><td>마지막 활동일</td><td>2025-01-15</td></tr>
      </table>

      <h4>3️⃣ Session (세션 기록)</h4>
      <table>
        <tr><th>필드</th><th>타입</th><th>설명</th><th>예시</th></tr>
        <tr><td>id</td><td>String</td><td>세션 고유 ID</td><td>"sess_001"</td></tr>
        <tr><td>project_id</td><td>String</td><td>연결된 프로젝트</td><td>"proj_001"</td></tr>
        <tr><td>date</td><td>DateTime</td><td>완료 일시</td><td>2025-01-15 14:30</td></tr>
        <tr><td>duration_seconds</td><td>int</td><td>실제 집중 시간</td><td>1500 (25분)</td></tr>
        <tr><td>is_success</td><td>bool</td><td>성공 여부 (≥80%)</td><td>true</td></tr>
        <tr><td>category</td><td>String</td><td>카테고리 (Phase 2)</td><td>"study"</td></tr>
      </table>

      <h4>4️⃣ Gallery (도감)</h4>
      <table>
        <tr><th>필드</th><th>타입</th><th>설명</th><th>예시</th></tr>
        <tr><td>id</td><td>String</td><td>도감 항목 ID</td><td>"gallery_001"</td></tr>
        <tr><td>fairy_id</td><td>String</td><td>졸업한 요정 ID</td><td>"fairy_001"</td></tr>
        <tr><td>completed_date</td><td>DateTime</td><td>졸업 일시</td><td>2025-01-31</td></tr>
        <tr><td>final_level</td><td>int</td><td>최종 레벨</td><td>4</td></tr>
        <tr><td>success_rate</td><td>float</td><td>성공률</td><td>0.85</td></tr>
        <tr><td>total_time_hours</td><td>float</td><td>총 집중 시간</td><td>25.5</td></tr>
        <tr><td>screenshot</td><td>String</td><td>스크린샷 경로 (선택)</td><td>"img/fairy_001.png"</td></tr>
      </table>

      <div class="hr"></div>

      <h3>🔗 데이터 관계도 (텍스트)</h3>
      <pre class="kbd" style="background:#1e293b;color:#e2e8f0;padding:16px;line-height:1.6;overflow-x:auto;">
┌─────────────────┐
│   Project       │ 1:1 연결
│  (목표 설정)    ├──────────┐
└─────────────────┘          │
                             ▼
                    ┌─────────────────┐
                    │     Fairy       │
                    │   (요정 상태)   │
                    └────────┬────────┘
                             │ 1:N 연결
                             ▼
                    ┌─────────────────┐
                    │    Session      │
                    │  (세션 기록)    │
                    └─────────────────┘
                             │
                    졸업 시 복사 ▼
                    ┌─────────────────┐
                    │    Gallery      │
                    │     (도감)      │
                    └─────────────────┘
      </pre>

      <h3>🔢 핵심 계산 로직</h3>
      <div class="example">
        <b>1. 현재 레벨 계산:</b><br>
        <span class="kbd">level = min(4, 1 + total_pomodoros // (project.daily_goal * project.duration_days / 4))</span><br><br>
        
        <b>2. 하루 달성 여부:</b><br>
        <span class="kbd">today_sessions = Session.filter(date == today).count()</span><br>
        <span class="kbd">is_achieved = today_sessions >= project.daily_goal</span><br><br>
        
        <b>3. 졸업 가능 여부:</b><br>
        <span class="kbd">can_graduate = (</span><br>
        <span class="kbd">  fairy.total_pomodoros >= project.daily_goal * project.duration_days</span><br>
        <span class="kbd">  AND days_since_start >= project.duration_days</span><br>
        <span class="kbd">  AND fairy.level >= 4</span><br>
        <span class="kbd">)</span><br><br>
        
        <b>4. 잠든 상태 판정:</b><br>
        <span class="kbd">is_sleeping = (today - fairy.last_active).days >= 10</span>
      </div>
    </div>

    <!-- 6. FAQ & 엣지 케이스 -->
    <div class="card">
      <h2>6. FAQ & 엣지 케이스 처리</h2>
      <p>개발 중 자주 나올 질문과 예외 상황 처리 방법입니다.</p>

      <h3>❓ 자주 묻는 질문</h3>
      
      <table>
        <tr><th>질문</th><th>답변</th></tr>
        <tr>
          <td><b>Q1. 중간에 목표를 변경할 수 있나요?</b></td>
          <td>
            <b>Phase 1:</b> 불가능. 프로젝트 시작 시 확정.<br>
            <b>Phase 2 이후:</b> 설정에서 "프로젝트 재시작" 가능 (데이터 초기화 경고)
          </td>
        </tr>
        <tr>
          <td><b>Q2. 여러 프로젝트를 동시에 진행할 수 있나요?</b></td>
          <td>
            <b>Phase 1:</b> 불가능. 1개 프로젝트만 활성화.<br>
            <b>Phase 3 이후:</b> 멀티 프로젝트 지원 검토 (복잡도 증가)
          </td>
        </tr>
        <tr>
          <td><b>Q3. 앱을 삭제했다가 재설치하면?</b></td>
          <td>
            로컬 DB만 사용하므로 데이터 소실.<br>
            <b>Phase 2 이후:</b> Firebase 백업 옵션 제공 검토
          </td>
        </tr>
        <tr>
          <td><b>Q4. 자정이 지나면 "하루 목표"가 리셋되나요?</b></td>
          <td>
            네. 디바이스 로컬 타임존 기준 00:00에 리셋.<br>
            타임존 변경 시: 새 타임존의 자정 기준 적용
          </td>
        </tr>
        <tr>
          <td><b>Q5. 25분 안에 앱을 끄면?</b></td>
          <td>
            백그라운드 타이머 동작 (OS 허용 시).<br>
            80% 미만 경과 시 실패 처리, 세션 기록 안됨.
          </td>
        </tr>
      </table>

      <div class="hr"></div>

      <h3>⚠️ 엣지 케이스 처리</h3>

      <h4>1. 목표 초과 달성</h4>
      <div class="example">
        <b>상황:</b> 30일 목표인데 20일 만에 60개 달성<br>
        <b>처리:</b><br>
        • 20일차에 "조기 졸업 가능" 알림<br>
        • 유저가 "졸업" 버튼 클릭 시 도감 등록<br>
        • 남은 10일은 보너스 기간 (선택적 계속 가능)
      </div>

      <h4>2. 목표 미달성</h4>
      <div class="example">
        <b>상황:</b> 30일 지났는데 40개만 달성 (목표 60개)<br>
        <b>처리:</b><br>
        • "목표를 달성하지 못했습니다" 메시지<br>
        • 도감 등록 불가 (회색으로 표시)<br>
        • 옵션 1: 프로젝트 연장 (+7일)<br>
        • 옵션 2: 새 프로젝트 시작 (현재 포기)
      </div>

      <h4>3. 앱 권한 거부</h4>
      <div class="example">
        <b>상황:</b> 알림 권한 거부<br>
        <b>처리:</b><br>
        • 앱은 정상 작동 (알림 없이)<br>
        • 설정에서 "알림 권한 요청" 버튼 표시<br>
        • 타이머 종료 시 앱 내 팝업으로 알림 대체
      </div>

      <h4>4. 날짜/시간 조작</h4>
      <div class="example">
        <b>상황:</b> 유저가 디바이스 시간을 앞으로 돌림<br>
        <b>처리:</b><br>
        • 서버 시간 없이 완벽한 방어 불가<br>
        • Phase 1: 조작 허용 (1인 게임이므로 큰 문제 없음)<br>
        • Phase 3: 서버 타임스탬프 검증 추가 검토
      </div>

      <h4>5. 타이머 중 앱 크래시</h4>
      <div class="example">
        <b>상황:</b> 타이머 실행 중 앱 강제 종료<br>
        <b>처리:</b><br>
        • 재시작 시 "중단된 세션" 감지<br>
        • "이어하기" vs "포기" 선택지 제공<br>
        • 이어하기: 남은 시간부터 재시작<br>
        • 포기: 세션 기록 안됨
      </div>

      <h4>6. 졸업 후 데이터</h4>
      <div class="example">
        <b>상황:</b> 졸업한 요정은 어떻게 되나요?<br>
        <b>처리:</b><br>
        • Fairy 데이터 → Gallery로 복사<br>
        • 원본 Fairy 데이터는 보관 (히스토리 참조용)<br>
        • Project.is_active = false 처리<br>
        • 새 프로젝트 시작 시 새 Fairy 생성
      </div>

      <p class="muted caption">⚠️ 위 엣지 케이스는 Phase 1에서 모두 구현할 필요는 없습니다. 출시 후 유저 피드백에 따라 우선순위를 조정하세요.</p>
    </div>


    <!-- 3. 목표 설정 시스템 (NEW) -->
    <div class="card">
      <h2>7. 목표 설정 시스템 ⭐ 핵심</h2>
      <p>유저가 앱 시작 시 <b>자신의 목표</b>를 직접 설정합니다.</p>
      
      <h3>설정 흐름</h3>
      <div class="example">
        <b>Q1:</b> "몇 일 동안 프로젝트를 진행하실 건가요?"<br>
        → 선택지: <span class="kbd">15일</span> / <span class="kbd">30일</span> / <span class="kbd">60일</span><br><br>
        <b>Q2:</b> "하루에 몇 개의 뽀모도로를 목표로 하시나요?"<br>
        → 선택지: <span class="kbd">1개</span> / <span class="kbd">2개</span> / <span class="kbd">3개</span> / <span class="kbd">4개</span><br><br>
        <b>결과:</b> "30일 동안 60개(하루 2개)를 목표로 요정을 키웁니다!"
      </div>

      <h3>목표 달성 보상</h3>
      <table>
        <tr><th>조건</th><th>보상</th></tr>
        <tr><td>하루 목표 달성</td><td>성장포인트 +1</td></tr>
        <tr><td>하루 목표 미달성</td><td>성장포인트 0 (패널티 없음)</td></tr>
      </table>
      <p class="muted caption">⚠️ 30일이 지나도 목표를 달성 못하면 요정은 성장이 멈춥니다. 시간 ≠ 성장</p>
    </div>

    <!-- 4. 성장 시스템 (UPDATED) -->
    <div class="card">
      <h2>8. 성장 시스템</h2>
      <p>성장은 <b>뽀모도로 달성 개수</b>로만 결정됩니다. 시간이 지나도 목표를 달성하지 않으면 성장하지 않습니다.</p>
      
      <h3>레벨업 조건 (30일 기준 예시)</h3>
      <table>
        <tr><th>레벨</th><th>필요 뽀모도로</th><th>기간 비유</th></tr>
        <tr><td>Lv1 (알)</td><td>0개</td><td>시작</td></tr>
        <tr><td>Lv2 (유아)</td><td>15개 (7일치)</td><td>약 1주</td></tr>
        <tr><td>Lv3 (청소년)</td><td>30개 (14일치)</td><td>약 2주</td></tr>
        <tr><td>Lv4 (성인)</td><td>45개 (21일치)</td><td>약 3주</td></tr>
        <tr><td>졸업 (성숙)</td><td>60개 + 30일 경과</td><td>프로젝트 완료</td></tr>
      </table>

      <div class="example">
        <b>예시 1:</b> 30일 동안 60개 목표 → 매일 2개씩 달성 → Lv4 도달 후 졸업 ✅<br>
        <b>예시 2:</b> 30일 동안 20개만 달성 → Lv2에서 멈춤 → 졸업 불가 ❌<br>
        <b>예시 3:</b> 15일 동안 45개 달성 (초과 달성) → Lv4 도달 → 15일차에 조기 졸업 가능 ✅
      </div>

      <p class="muted caption">공식: <span class="kbd">current_level = min(4, 1 + completed_pomodoros // (total_goal / 4))</span></p>
    </div>

    <!-- 5. 뽀모도로 시스템 -->
    <div class="card">
      <h2>9. 뽀모도로 시스템</h2>
      <table>
        <tr><th>항목</th><th>내용</th></tr>
        <tr><td>타이머</td><td>25분 집중 / 5분 휴식 (기본)</td></tr>
        <tr><td>성공 판정</td><td>타이머의 80% 이상 경과 시 성공</td></tr>
        <tr><td>진행 중 연출</td><td>요정이 정원을 돌아다니는 애니메이션</td></tr>
        <tr><td>완료 시</td><td>반짝이는 파티클 + 성장 포인트 획득 알림</td></tr>
      </table>
      <p class="muted caption">타이머 실행 중 요정은 스노우볼 안을 자유롭게 움직입니다.</p>
    </div>

    <!-- 6. 방치 시스템 -->
    <div class="card">
      <h2>10. 방치 & 복귀 시스템</h2>
      <table>
        <tr><th>상태</th><th>조건</th><th>연출</th></tr>
        <tr><td>정상</td><td>10일 이내 접속</td><td>요정 활발히 움직임</td></tr>
        <tr><td>잠든 상태</td><td>10일 이상 미접속</td><td>요정과 정원이 잠듦 (흑백 필터)</td></tr>
        <tr><td>복귀</td><td>뽀모도로 1개 완료</td><td>요정이 깨어남 + 색상 복구</td></tr>
      </table>
      <p><b>동기 부여:</b> 잠든 요정을 보며 "다시 시작해야지" 느낌. 패널티보다는 따뜻한 톤.</p>
      <p class="muted caption">데이터는 보존되며, 복귀 시 이어서 진행 가능.</p>
    </div>

    <!-- 7. IAP: 정원 아이템 -->
    <div class="card">
      <h2>11. IAP: 정원 아이템 (성장 부스트)</h2>
      <p>목표 달성에 어려움을 겪는 유저를 위한 <b>선택적 도움</b> 아이템입니다.</p>
      
      <table>
        <tr><th>아이템</th><th>효과</th><th>제한</th></tr>
        <tr><td>성장 물약</td><td>성장포인트 +7 (1주치)</td><td>레벨당 1개만 사용 가능</td></tr>
        <tr><td>시간 씨앗</td><td>성장포인트 +14 (2주치)</td><td>레벨당 1개만 사용 가능</td></tr>
      </table>

      <div class="example">
        <b>예시:</b> Lv1→Lv2로 올리려면 15개 필요. 10개만 모았다면?<br>
        → 성장 물약 구매 → +7 포인트 → 17개로 레벨업 가능<br>
        → Lv2에서 다시 1개 더 구매 가능 (레벨당 1개 제한)
      </div>

      <p class="muted caption">⚠️ 완전 스킵 방지: 레벨당 1개 제한으로 최소한의 노력은 필요합니다.</p>
    </div>

    <!-- 8. 도감 & 졸업 시스템 -->
    <div class="card">
      <h2>12. 도감 & 졸업 시스템</h2>
      <p>프로젝트 기간(15/30/60일)이 끝나고 목표를 달성하면 요정이 <b>졸업</b>합니다.</p>
      
      <h3>졸업 조건</h3>
      <ul>
        <li>설정한 기간 경과 (예: 30일)</li>
        <li>목표 뽀모도로 달성 (예: 60개)</li>
        <li>최소 Lv4 도달</li>
      </ul>

      <h3>졸업 연출</h3>
      <div class="example">
        1. 요정이 성숙한 모습으로 변신<br>
        2. 스노우볼에서 빛이 번쩍<br>
        3. "축하합니다! [프로젝트명] 완료!" 메시지<br>
        4. 도감에 요정 등록 (외형, 레벨, 달성률 기록)<br>
        5. 새로운 알 받기 버튼 표시
      </div>

      <h3>도감 구성</h3>
      <ul>
        <li>졸업한 요정 목록 (이름, 외형, 달성 통계)</li>
        <li>전체 달성률 (예: 3/10 마리 완성)</li>
        <li>MVP에서는 1종 요정만 제공</li>
      </ul>
    </div>

    <!-- 9. 기술 스펙 -->
    <div class="card">
      <h2>13. 기술 스펙 (MVP)</h2>
      <div class="grid cols-2">
        <div>
          <h3>플랫폼/엔진</h3>
          <ul>
            <li>Flutter (iOS/Android)</li>
            <li>애니메이션: 간단한 Rive or Sprite</li>
          </ul>
          <h3>데이터</h3>
          <ul>
            <li>로컬: Hive/SQLite</li>
            <li>분석: Firebase Analytics</li>
          </ul>
        </div>
        <div>
          <h3>광고/IAP</h3>
          <ul>
            <li>AdMob (광고 제거 IAP)</li>
            <li>성장 아이템 IAP</li>
          </ul>
          <h3>데이터 모델</h3>
          <ul>
            <li><span class="kbd">project</span>: duration, daily_goal, start_date</li>
            <li><span class="kbd">fairy</span>: level, total_pomodoros, is_sleeping</li>
            <li><span class="kbd">session</span>: date, success_count</li>
            <li><span class="kbd">gallery</span>: graduated_fairies[]</li>
          </ul>
        </div>
      </div>
    </div>



    <!-- 10. 로드맵 & Phase 2/3 계획 -->
    <div class="card">
      <h2>14. 개발 로드맵 & Phase 계획</h2>
      <p class="muted">MVP(Phase 1)로 핵심 루프를 검증한 후, 유저 피드백에 따라 단계적으로 기능을 확장합니다.</p>
      
      <table>
        <tr><th>Phase</th><th>기간</th><th>주요 기능</th><th>목표</th></tr>
        <tr>
          <td><b>Phase 1<br>MVP</b></td>
          <td>2주</td>
          <td>
            • 목표 설정 시스템<br>
            • 뽀모도로 타이머<br>
            • 요정 성장 4단계 (단일 종)<br>
            • 졸업 & 도감 등록<br>
            • 방치 시스템 (잠든 상태)<br>
            • IAP: 광고 제거
          </td>
          <td>
            1사이클 완주 검증<br>
            D1 Ret ≥ 35%
          </td>
        </tr>
        <tr>
          <td><b>Phase 2<br>다양성</b></td>
          <td>+2주</td>
          <td>
            • <b>카테고리 4개 분기</b> (공부/운동/소셜/취미)<br>
            • <b>타입별 요정</b> 4종 (Lv3 시점 확정)<br>
            • <b>색상 커스터마이즈</b> (머리색 3종 선택)<br>
            • <b>정원 상태 3단계</b> (정상/약화/황폐)<br>
            • 태그별 힌트 연출 (파티클 색상)
          </td>
          <td>
            재방문 동기 강화<br>
            도감 수집 욕구 자극
          </td>
        </tr>
        <tr>
          <td><b>Phase 3<br>수익화</b></td>
          <td>+2주</td>
          <td>
            • <b>감정 시스템</b> (Mood 3단계)<br>
            • <b>성장 부스트 아이템</b> (IAP)<br>
            • <b>보상형 광고</b> (세션 후)<br>
            • 정원 꾸미기 아이템<br>
            • 추가 통계 & 인사이트
          </td>
          <td>
            수익화 최적화<br>
            광고 시청률 ≥ 50%
          </td>
        </tr>
      </table>

      <div class="hr"></div>

      <h3>🎯 Phase 2 상세: 카테고리 분기 시스템</h3>
      <p>Lv3 도달 시 가장 많이 한 카테고리에 따라 요정 타입이 결정됩니다.</p>
      
      <table>
        <tr><th>카테고리</th><th>요정 타입</th><th>스노우볼 내 특징</th><th>대표 대사</th></tr>
        <tr>
          <td>공부 📚</td>
          <td>지식 요정</td>
          <td>차분, 투명한 책장 모양 날개, 청록빛 파티클</td>
          <td>"배움은 빛이야."</td>
        </tr>
        <tr>
          <td>운동 💪</td>
          <td>에너지 요정</td>
          <td>활발, 도전적, 역동적인 황금빛 파티클</td>
          <td>"움직이면 빛도 흐르지!"</td>
        </tr>
        <tr>
          <td>소셜 💬</td>
          <td>하모니 요정</td>
          <td>공감형, 작은 종/등불, 따뜻한 오렌지빛 오라</td>
          <td>"함께일 때 마음이 자라."</td>
        </tr>
        <tr>
          <td>취미 🎨</td>
          <td>창조 요정</td>
          <td>팔레트 컬러, 표현적, 무지갯빛 파티클</td>
          <td>"집중엔 색이 있어."</td>
        </tr>
      </table>

      <div class="example">
        <b>타입 결정 로직:</b><br>
        <span class="kbd">dominant_tag = max(["study","exercise","social","hobby"], key=lambda t: tag_stats[t].total)</span><br><br>
        <b>힌트 시스템:</b><br>
        • Lv1~Lv2: 뽀모도로 완료 시 해당 카테고리 색상 파티클 표시<br>
        • Lv3 도달: "당신은 [카테고리]에 집중했군요!" 메시지 + 타입 확정 연출
      </div>

      <div class="hr"></div>

      <h3>🎨 Phase 2 상세: 색상 커스터마이즈</h3>
      <p>알 단계에서 요정의 머리색을 선택하여 개인화를 부여합니다.</p>
      
      <table>
        <tr><th>항목</th><th>설명</th><th>구현 방식</th></tr>
        <tr>
          <td>머리색</td>
          <td>3종 파스텔톤<br>(민트, 라벤더, 핑크)</td>
          <td>알 단계에서 1회 선택<br>이후 고정</td>
        </tr>
        <tr>
          <td>눈색</td>
          <td>머리색 기반 자동 매칭</td>
          <td>별도 선택 없음</td>
        </tr>
        <tr>
          <td>의상/날개</td>
          <td>타입별 자동 변화</td>
          <td>dominant_tag 기반</td>
        </tr>
      </table>

      <div class="example">
        <b>UI 플로우:</b><br>
        1. 알 선택 화면에서 "요정의 첫인상을 정해주세요" 안내<br>
        2. 3개 색상 칩 표시 (슬라이드 or 탭 선택)<br>
        3. 선택 즉시 알 색상 미리보기<br>
        4. "시작하기" 버튼 → 프로젝트 시작<br><br>
        <b>데이터 저장:</b> <span class="kbd">user_prefs["fairy_color"] = "mint" | "lavender" | "pink"</span>
      </div>

      <p class="muted caption">⚠️ Phase 2는 MVP 출시 후 유저 반응을 보고 진행 여부를 결정합니다. 도감 수집 욕구가 높다면 우선 개발, 그렇지 않다면 Phase 3(수익화)를 먼저 진행할 수 있습니다.</p>
    </div>

    <!-- 11. MVP 개발 스펙 -->
    <div class="card" style="background:linear-gradient(135deg, #ecfeff 0%, #fff 100%);">
      <h2>15. 📌 MVP 개발 스펙 — Phase 1 (2주 목표)</h2>
      <p class="muted">핵심 루프 1사이클을 완성하여 유저 피드백을 받을 수 있는 최소 버전</p>
      
      <div class="grid cols-3">
        <div>
          <h3>✅ 포함 기능</h3>
          <ul>
            <li>목표 설정 UI (기간 + 하루 목표)</li>
            <li>뽀모도로 타이머 (25/5분)</li>
            <li>세션 성공 판정 (≥80%)</li>
            <li>요정 성장 4단계 (알→유아→청소년→성인)</li>
            <li>졸업 & 도감 등록</li>
            <li>10일 방치 → 잠든 상태</li>
            <li>IAP: 광고 제거</li>
          </ul>
        </div>
        
        <div>
          <h3>❌ 제외 기능 (Phase 2/3)</h3>
          <ul>
            <li>카테고리/태그 시스템</li>
            <li>타입 분기 (4종 요정)</li>
            <li>정원 상태 변화 (정상/약화/황폐)</li>
            <li>감정 시스템 (Mood)</li>
            <li>보상형 광고</li>
            <li>성장 부스트 아이템</li>
            <li>색상 커스터마이즈</li>
          </ul>
        </div>
        
        <div>
          <h3>📦 필요 에셋</h3>
          <ul>
            <li>요정 1종 × 4단계 = 4장</li>
            <li>스노우볼 배경 2종 (정상/잠듦)</li>
            <li>졸업 연출 1장</li>
            <li>UI 아이콘 세트</li>
          </ul>
          <p class="muted caption"><b>총 7장 내외</b> - 2주 안에 제작 가능한 수준</p>
        </div>
      </div>

      <div class="hr"></div>
      <h3>개발 우선순위</h3>
      <table>
        <tr><th>주차</th><th>작업</th><th>검증</th></tr>
        <tr><td>1주차</td><td>타이머 + 목표 설정 + 세션 저장</td><td>뽀모도로 완료 → 카운트 증가</td></tr>
        <tr><td>2주차</td><td>요정 성장 로직 + 도감 + 방치</td><td>1사이클 완주 (알→졸업)</td></tr>
      </table>

      <div class="hr"></div>
      <h3>KPI 목표</h3>
      <div class="grid cols-3">
        <div><span class="check">D1 Retention ≥ 35%</span></div>
        <div><span class="check">평균 세션/일 ≥ 2</span></div>
        <div><span class="check">1사이클 완료율 ≥ 15%</span></div>
      </div>
    </div>


    <div class="footer">© 2025 Fairy Garden (FocusPet) — Internal PRD v1.0</div>
  </div>
</body>
</html>
